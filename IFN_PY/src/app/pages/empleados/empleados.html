<div class="empleados-container">
  
  <header class="header">
    <h2>ğŸ‘” GestiÃ³n de Empleados</h2>
    <button (click)="gestionarVisibilidadFormulario()" class="btn-primary">
      {{ mostrarFormulario ? 'Ocultar Formulario' : 'Registrar Nuevo Empleado' }}
    </button>
  </header>
  
  <hr>

  <div *ngIf="mostrarFormulario" class="form-section">
    <div class="card-form">
      <h3 class="form-title">
        {{ editandoEmpleadoId ? 'ğŸ“ Editando Cargo del Empleado' : 'Asignar Persona a Empleado' }}
      </h3>

      <form [formGroup]="empleadoForm" (ngSubmit)="gestionarEmpleado()">
        <div class="form-grid">
          
          <div class="form-group" [class.hidden]="editandoEmpleadoId">
            <label for="id_persona">Persona a Emplear *</label>
            <select id="id_persona" formControlName="id_persona" [required]="!editandoEmpleadoId">
              <option value="" disabled selected>Seleccione la persona...</option>
              <option *ngFor="let p of personasDisponibles" [value]="p.id_persona">{{ p.nombre_completo_razon_social }} (ID: {{p.id_persona}})</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="id_cargo_empleado">Cargo *</label>
            <select id="id_cargo_empleado" formControlName="id_cargo_empleado" required>
              <option value="" disabled selected>Seleccione el cargo...</option>
              <option *ngFor="let cargo of cargos" [value]="cargo.id_cargo">{{ cargo.nombre_cargo }}</option>
            </select>
          </div>
        </div>
        
        <button type="submit" class="btn-submit" [disabled]="empleadoForm.invalid">
          {{ editandoEmpleadoId ? 'Guardar Cargo' : 'Crear Empleado' }}
        </button>

        <button *ngIf="mostrarFormulario" type="button" (click)="resetFormulario()" class="btn-secondary btn-cancel">
          Cancelar
        </button>
      </form>
    </div>
  </div>

  <hr *ngIf="mostrarFormulario">

  <div class="empleados-grid">
    <div *ngIf="empleados.length === 0" class="no-data">
      <p>No hay empleados registrados. Â¡Asigna el primero!</p>
    </div>

    <div *ngFor="let empleado of empleados" class="empleado-card">
      <div class="card-header">
        <h3 class="empleado-nombre">{{ empleado.nombre_completo }}</h3>
        <span [class]="obtenerClaseEstado(empleado.estado)">{{ empleado.estado | uppercase }}</span>
      </div>

      <p class="cargo-text">**Cargo:** {{ empleado.nombre_cargo }}</p>
      
      <hr class="card-divider">

      <div class="card-content">
        <div class="content-item">
          <span class="label">ğŸ“§ Correo:</span>
          <span class="value-highlight">{{ empleado.correo }}</span>
        </div>
        <div class="content-item">
          <span class="label">ğŸ†” IdentificaciÃ³n:</span>
          <span>{{ empleado.numero_identificacion }}</span>
        </div>
        <div class="content-item">
          <span class="label">ğŸ”‘ ID Empleado:</span>
          <span>{{ empleado.id_empleado }}</span>
        </div>
      </div>

      <div class="card-footer">
        <button class="btn-action btn-edit" (click)="iniciarEdicion(empleado)">ğŸ“ Editar Cargo</button>
      </div>
    </div>
  </div>
</div>