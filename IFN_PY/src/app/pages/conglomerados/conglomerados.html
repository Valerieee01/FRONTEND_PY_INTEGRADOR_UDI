<div class="dashboard-container">
    <header class="dashboard-header">
        <h1>üó∫Ô∏è Gesti√≥n y Visualizaci√≥n de Conglomerados</h1>
    </header>

    <div class="main-layout">
        
        <div class="sidebar">
            <div class="filter-card">
                <h3>üîç Filtros de B√∫squeda</h3>
                <form [formGroup]="filtroForm" (ngSubmit)="cargarConglomerados()">
                    
                    <div class="form-group">
                        <label for="busqueda">C√≥digo o Palabra clave</label>
                        <input id="busqueda" type="text" formControlName="busqueda" placeholder="Ej: CGL001, Bosque">
                    </div>

                    <div class="altitud-group">
                        <label>Rango de Altitud (m)</label>
                        <div class="input-range">
                            <input type="number" formControlName="altitudMin" placeholder="M√≠n. Altitud">
                            <span>a</span>
                            <input type="number" formControlName="altitudMax" placeholder="M√°x. Altitud">
                        </div>
                    </div>

                    <div class="filter-actions">
                        <button type="submit" class="btn-primary btn-filter" [disabled]="busquedaControl?.invalid">Aplicar Filtros</button>
                        <button type="button" class="btn-secondary btn-clear" (click)="limpiarFiltros()">Limpiar</button>
                    </div>
                </form>
            </div>
            
            <hr>

            <div class="list-container">
                <h3>Lista de Conglomerados ({{ conglomerados.length }})</h3>
                <div *ngIf="conglomerados.length === 0" class="no-data">
                    No se encontraron conglomerados con los filtros aplicados.
                </div>
                
                <ul class="conglomerado-list">
                    <li *ngFor="let c of conglomerados" 
                        [class.selected]="c.id_conglomerado === conglomeradoSeleccionado?.id_conglomerado"
                        (click)="seleccionarConglomerado(c)">
                        <span class="list-code">{{ c.codigo }}</span>
                        <span class="list-detail">Alt: {{ c.altitud }} m | Fecha: {{ c.fecha }}</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="content-detail">
            <div *ngIf="!conglomeradoSeleccionado" class="placeholder-card">
                <h2>üìä Seleccione un Conglomerado</h2>
                <p>Haga clic en un √≠tem de la izquierda para ver su detalle geogr√°fico y la lista de subparcelas asociadas.</p>
            </div>

            <div *ngIf="conglomeradoSeleccionado" class="detail-card">
                <h2 class="detail-title">Detalle: {{ conglomeradoSeleccionado.codigo }}</h2>
                
                <div class="conglomerado-data-grid">
                    <div class="data-item">
                        <span class="data-label">C√≥digo:</span>
                        <span class="data-value">{{ conglomeradoSeleccionado.codigo }}</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Fecha Muestreo:</span>
                        <span class="data-value">{{ conglomeradoSeleccionado.fecha }}</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Altitud:</span>
                        <span class="data-value">{{ conglomeradoSeleccionado.altitud }} m</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Coordenadas:</span>
                        <span class="data-value">{{ conglomeradoSeleccionado.latitud }}, {{ conglomeradoSeleccionado.longitud }}</span>
                    </div>
                </div>
                
                <div class="observaciones-box">
                    <span class="data-label">Observaciones:</span>
                    <p>{{ conglomeradoSeleccionado.observaciones || 'N/A' }}</p>
                </div>

                <hr>

                <h3 class="subparcela-title">Subparcelas Asociadas ({{ subparcelas.length }})</h3>
                <table class="subparcela-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Tipo</th>
                            <th>√Årea (m¬≤)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let s of subparcelas">
                            <td>{{ s.id_subparcela }}</td>
                            <td>{{ s.nombre }}</td>
                            <td>{{ s.tipo }}</td>
                            <td>{{ s.area }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>